# Тестовый сценарий для University Workload Database

# --- Базовые команды и проверка связи ---
help

# --- Тестирование 'add node' ---
# Успешное добавление
add node faculty
add node faculty/science
add node faculty/arts
add node faculty/science/math
add node faculty/science/physics
add node faculty/arts/history
# Повторное добавление существующего узла (должно быть без ошибки, просто подтверждение)
add node faculty/science
# Добавление узла с путем, где промежуточный узел уже существует
add node faculty/science/chemistry
# Добавление глубоко вложенного узла
add node faculty/science/math/applied_math/group1

# Ошибки 'add node'
add node
# -> Ожидается: Usage: add node <path>
add node faculty/science/math/имя_с_пробелом!_и_воскл_знаком
# -> Ожидается: Error: Invalid character...
add node faculty/science//math_double_slash
# -> Ожидается: Успешно (faculty/science/math_double_slash) или ошибка о пустом сегменте, в зависимости от реализации splitPath/проверки
add node ""
# -> Ожидается: Error: Cannot create node with empty path.
add node /
# -> Ожидается: Error: Invalid node path format... (или Node added/exists at path: "" если / отбрасывается)

# --- Тестирование 'add employee' ---
# Успешное добавление
add employee faculty/science/math 'Ivanov I.I.' lectures:40 seminars:60 project:20
add employee faculty/science/math 'Petrov P.P.' seminars:80 labs:40
add employee faculty/science/physics 'Sidorov S.S.' lectures:30 seminars:50 labs:60 research:100
add employee faculty/science/physics 'Kuznetsova K.K.' seminars:70 project:30 research:20
add employee faculty/arts/history 'Smirnova A.A.' lectures:60 seminars:40 archive:50
add employee faculty/arts/history 'Popov V.V.' lectures:50 seminars:50
add employee faculty/science/math/applied_math/group1 'Student X' coursework:15
# Добавление сотрудника без нагрузки
add employee faculty/science/chemistry 'Zotov Z.Z.'
# -> Ожидается: Warning: Adding employee 'Zotov Z.Z.' with no workload specified. ... Employee 'Zotov Z.Z.' added...

# Ошибки 'add employee'
add employee
# -> Ожидается: Usage: add employee <path> '<name>' ...
add employee faculty/non_existent_dept 'Test User' lectures:10
# -> Ожидается: Error: Node not found at path: 'faculty/non_existent_dept'...
add employee faculty/science/math 'BadHours User' lectures:abc seminars:20
# -> Ожидается: Error: Invalid number format for hours...
add employee faculty/science/math 'NegativeHours User' lectures:-10
# -> Ожидается: Error: Workload hours for type 'lectures' cannot be negative...
add employee faculty/science/math 'User/With/Slash' lectures:10
# -> Ожидается: Error: Invalid employee name...
add employee faculty/science/math 'Colon:In:Name' lectures:10
# -> Ожидается: Error: Invalid employee name...
add employee faculty/science/math 'Quote\'InName' lectures:10
# -> Ожидается: Error: Invalid employee name...
add employee faculty/science/math 'Ivanov I.I.' lectures:50 # Попытка добавить существующего
# -> Ожидается: Error: Employee 'Ivanov I.I.' already exists...
add employee faculty/science/math 'ValidName' bad:type:10
# -> Ожидается: Error: Invalid workload format for item 'bad:type:10'...
add employee faculty/science/math 'ValidName' lectures:10 extra_token
# -> Ожидается: Error: Invalid workload format for item 'extra_token'... (или другая ошибка о лишних аргументах)
add employee faculty/science/math 'NoQuoteName' lectures:10
# -> В зависимости от вашего tokenize, это может сработать или нет. Если tokenize требует кавычки.
#    Если 'NoQuoteName' будет токеном имени, а 'lectures:10' следующим, то
#    Ожидается: Usage: add employee <path> '<name>' ... (так как не хватает аргументов для нагрузки)
#    Либо, если ваш tokenize более гибкий: Error: Invalid employee name... (если имя должно быть в кавычках)

# --- Тестирование 'query' ---
# Запрос к существующему узлу с сотрудниками
query columns name lectures seminars project where faculty/science/math row_sum
# Запрос к узлу, где есть под-узлы с сотрудниками
query columns name lectures seminars labs research project where faculty/science row_sum
# Запрос к узлу с другими типами нагрузки
query columns name lectures seminars archive where faculty/arts/history
# Запрос к узлу без сотрудников (но узел существует)
add node faculty/empty_dept
query columns name lectures where faculty/empty_dept
# -> Ожидается: No employees found under path: 'faculty/empty_dept'
# Запрос с несуществующими столбцами (типами нагрузки)
query columns name non_existent_workload another_bad_column where faculty/science/math
# -> Ожидается: Таблица с именами сотрудников и 0 для несуществующих столбцов.
# Запрос к несуществующему узлу
query columns name lectures where faculty/non_existent_dept_for_query
# -> Ожидается: Error: Node not found for query: 'faculty/non_existent_dept_for_query'
# Запрос без столбцов
query columns where faculty/science/math
# -> Ожидается: Error: No columns specified for query.
# Запрос с неверной структурой
query name lectures where faculty/science/math
# -> Ожидается: Usage: query columns <col1> ...
query columns name lectures faculty/science/math row_sum # пропущено 'where'
# -> Ожидается: Error: 'where' keyword missing...

# Тестирование query к корню (если "" или "/" поддерживается как путь к корню)
# query columns name lectures where "" row_sum # или "/"
# -> Ожидается: Вывод всех сотрудников из всех узлов

# --- Тестирование 'save' ---
save test_db_output.txt
# -> Ожидается: Database saved to 'test_db_output.txt'
# Проверить содержимое файла test_db_output.txt вручную

# Ошибки 'save'
save
# -> Ожидается: Error: Missing filename for 'save' command.
save file1.txt file2.txt
# -> Ожидается: Error: Too many arguments for 'save' command.
save bad/path/file.txt
# -> Ожидается: Error: Filename 'bad/path/file.txt' should not contain path separators...

# --- Тестирование 'load' ---
# Сначала сохраним что-то, потом очистим и загрузим
add node for_load_test
add employee for_load_test 'Loader Man' loading:100
save for_load_test_db.txt

# "Очистка" БД (предполагая, что load несуществующего файла очищает)
load _temp_empty_to_clear_db.txt
# Проверка, что база пуста (или почти пуста)
query columns name loading where for_load_test
# -> Ожидается: No employees found... (или ошибка, если узел for_load_test тоже удалился)

# Загрузка сохраненных данных
load for_load_test_db.txt
# -> Ожидается: Database loaded from 'for_load_test_db.txt'
# Проверка загруженных данных
query columns name loading where for_load_test
# -> Ожидается: Вывод 'Loader Man' с loading:100

# Ошибки 'load'
load
# -> Ожидается: Error: Missing filename for 'load' command.
load file1.txt file2.txt
# -> Ожидается: Error: Too many arguments for 'load' command.
load non_existent_file_to_load.txt
# -> Ожидается: Error opening file for loading: 'non_existent_file_to_load.txt'
# (Можно создать файл с некорректным форматом и проверить его загрузку)
# Пример некорректного файла (создать вручную my_corrupted_db.txt):
# node faculty
# employee faculty/cs 'Test' lectures_INVALID_FORMAT
# load my_corrupted_db.txt
# -> Ожидается: Warning (load line ...): Invalid workload format...

# --- Тестирование неизвестных команд и пустого ввода ---
unknown_command_test
# -> Ожидается: Unknown command: 'unknown_command_test'.
# (пустая строка - нажать Enter)
# -> Ожидается: (ничего, новое приглашение)
    # (строка из пробелов - нажать пробелы и Enter)
# -> Ожидается: (ничего, новое приглашение)

# --- Конец тестов ---
# Для ручного завершения клиента:
# client_exit